---
import blogPosts from '~/blogdata/blogposts.json'

const uniqueTags = Array.from(new Set(blogPosts.map((post) => post.tag)));
let selectedTag = '';
---

<a class="py-10 px-6 mx-auto max-w-6xl lg:px-8 lg:py-20 flex flex-col gap-y-6 relative md:flex-row md:gap-x-20 md:items-center" href={blogPosts[0].slug}>
    <img class="w-full aspect-video rounded-2xl object-cover md:aspect-auto md:h-96" src={blogPosts[0].image} alt={blogPosts[0].title}>
    <div class="md:py-6">
        <div class="flex justify-between pb-1 md:pb-0.5">
            <p class="text-sm font-semibold tracking-wide text-transparent bg-clip-text bg-gradient-to-t from-purple-900 to-accent">{blogPosts[0].tag}</p>
            <p class="text-sm text-muted tracking-wide leading-relaxed md:hidden">{blogPosts[0].date}</p>
        </div>
        <h2 class="font-black text-muted md:text-white text-3xl md:text-4xl leading-tight pb-3 md:pb-4">{blogPosts[0].title}</h2>
        <p class="text-muted">{blogPosts[0].content.slice(0, 270)}</p>
        <div class="hidden md:flex flex-row items-center md:pt-4">
            <p class="text-sm text-muted tracking-wide leading-relaxed w-fit whitespace-nowrap pr-8">{blogPosts[0].date}</p>
            <hr class="w-full border-textdark translate-y-1">
        </div>
    </div>
    <div class="w-64 h-64 md:w-96 md:h-96 md:-left-60 md:-bottom-20 rounded-full bg-accent blur-3xl opacity-20 absolute -bottom-10 -left-20 scale-150 -z-10"></div>
</a>


<div class="overflow-hidden">
    <section class="px-6 mx-auto max-w-6xl lg:px-8 lg:py-20">
        <div class="flex flex-row items-center">
            <h2 class="w-fit text-2xl whitespace-nowrap text-muted pr-4 font-black">Latest posts</h2>
            <hr class="w-full border-textdark">
        </div>
        
        <div class="flex flex-row flex-wrap gap-4 pt-4 pb-12">
            <div class="p-px bg-gradient-to-tr from-purple-400 to-accent rounded-lg">
                <button class={`py-1 px-3 rounded-lg text-sm ${selectedTag === '' ? 'bg-accent' : 'bg-primary'}`} on:click={() => selectedTag = ''}>All</button>
            </div>
            {uniqueTags.map((tag) => (
                <div class="p-px bg-gradient-to-tr from-purple-400 to-accent rounded-lg">
                    <button class={`py-1 px-3 rounded-lg text-sm ${selectedTag === tag ? 'bg-accent' : 'bg-primary'}`} on:click={() => selectedTag = tag}>
                        {tag}
                    </button>
                </div>
            ))}
        </div>

        <div class="relative md:grid md:grid-cols-3 md:grid-rows-3 md:gap-12">
            <div class="w-96 h-96 rounded-full bg-gradient blur-3xl opacity-20 absolute top-1/2 -translate-y-1/2 -right-40 scale-150 -z-10 md:-right-80"></div>
            <div class="w-96 h-96 rounded-full bg-bluegradient blur-3xl opacity-20 absolute left-1/2 -translate-x-1/2 -bottom-60 scale-125 md:scale-150 md:-bottom-80 -z-10"></div>
            {blogPosts.slice(1).map((post) => (
                <div>
                    <a href={`${post.slug}`}>
                    <div class="mt-6 pb-2 border-b border-textdark last:border-b-0 md:border-b-0 md:mt-0">
                        <img class="w-full h-40 rounded-2xl object-cover md:aspect-video md:h-48" src={post.image} alt={post.title}>
                        <div class="flex justify-between py-4 pb-2">
                            <p class="text-sm font-semibold tracking-wide text-transparent bg-clip-text bg-gradient-to-t from-purple-900 to-accent">{post.tag}</p>
                            <p class="text-sm text-muted tracking-wide leading-relaxed md:hidden">{post.date}</p>
                        </div>
                        <h2 class="font-black text-muted text-2xl leading-tight pb-3">{post.title}</h2>
                        <div class="hidden md:flex flex-row items-center">
                            <p class="text-sm text-muted tracking-wide leading-relaxed whitespace-nowrap w-fit pr-8">{post.date}</p>
                            <hr class="w-full border-textdark">
                        </div>
                    </div>
                    </a>
                </div>
            ))}
        </div>
    </section>
</div>